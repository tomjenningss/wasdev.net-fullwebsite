<!DOCTYPE html>
<html lang="en-US">
<head>
	<!-- SITE MON : START (DO NOT DELETE) -->
	<!-- developerWorks monitoring token -->
	<!-- SITE MON : END (DO NOT DELETE) -->
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<!-- v18 meta -->
	<meta name="geo.country" content="ZZ" />
	<meta name="dcterms.rights" content="© Copyright IBM Corp. 2016" />
	<meta name="dcterms.date" content="2016-07-18" />
	<meta name="keywords" content="MicroProfile," />
	<meta name="robots" content="index, follow" />
	<link rel="shortcut icon" href="https://www.ibm.com/favicon.ico" />

		<!-- end of v18 meta -->

<link rel="profile" href="http://gmpg.org/xfn/11">
<link rel="pingback" href="https://developer.ibm.com/wasdev/xmlrpc.php">
<script>
		 digitalData = {
		  "page":{
		    "category":{
		      "primaryCategory":"SOFDCWSVZZ",		      "ibm":[

		      ]
		    },
		    "pageInfo":{
		      "effectiveDate":"2016-07-18",
		      "expiryDate":"2020-07-18",
		      "language":"en-US",
		      "publishDate":"2017-03-08",
		      "publisher":"IBM Corporation",
		      "version":"v18",
		      "pageID":"",
		      "ibm":{
						"contentDelivery":"HTML",
		        "contentProducer":"IBM Northstar Template Generator 2.0",
		        "country":"ZZ",
		        "industry":"ZZ",
		        "owner":"Jamie Pickett\/Boulder\/IBM",
		        "siteID":"DWNEXT",
						"subject":"SW700",
		        "type":"SW700",
		        "cmClientID":"50200000| DWNEXT",
		        "encoding":"utf8",
		        "encodingRaw":"utf-8",
		        "title":"Writing a simple MicroProfile application (2): Adding persistence",
						"contentType": "doc",
						"wpid":"9",
						"topics":"MicroProfile,",
						"contentArea": "Coding, Java EE"
		      },
		      "metrics":[

		      ],
		      "keywords":"MicroProfile,",
		      "description":"Writing a simple MicroProfile application (2): Adding persistence"
		    },
		    "attributes":[

		    ],
		  },
		  "event_coordinator":[

		  ],
		  "isLoaded":true,
		  "user":{
		    "profile":[

		    ],
		    "segment":{

		    }
		  }
		};
	 </script>
<title>Writing a simple MicroProfile application (2): Adding persistence - WASdev</title>

<!-- This site is optimized with the Yoast SEO plugin v9.0.2 - https://yoast.com/wordpress/plugins/seo/ -->
<meta name="description" content="Take the MicroProfile application built in a previous article and add persistence using a MongoDB database."/>
<link rel="canonical" href="index.html%3Fp=21602.html" />
<link rel="publisher" href="https://plus.google.com/u/0/+WASdevNet"/>
<!-- / Yoast SEO plugin. -->

<link rel='dns-prefetch' href='https://1.www.s81c.com/' />
<link rel='dns-prefetch' href='https://www.ibm.com/' />
<link rel='dns-prefetch' href='https://s.w.org/' />
<link rel="alternate" type="application/rss+xml" title="WASdev &raquo; Feed" href="feed/index.html" />
<link rel="alternate" type="application/rss+xml" title="WASdev &raquo; Comments Feed" href="comments/feed/index.html" />
<meta name="segment" property="developerWorks (developerWorks)" productTitle="developerWorks" value="WASdev (developerWorks)">
<link rel="alternate" type="application/rss+xml" title="WASdev &raquo; Writing a simple MicroProfile application (2): Adding persistence Comments Feed" href="docs/writing-simple-microprofile-application-2-adding-persistence/feed/index.html" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/11\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/11\/svg\/","svgExt":".svg","source":{"concatemoji":"\/\/dw1.s81c.com\/dw\/wp-includes\/js\/wp-emoji-release.min.js"}};
			!function(a,b,c){function d(a,b){var c=String.fromCharCode;l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,a),0,0);var d=k.toDataURL();l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,b),0,0);var e=k.toDataURL();return d===e}function e(a){var b;if(!l||!l.fillText)return!1;switch(l.textBaseline="top",l.font="600 32px Arial",a){case"flag":return!(b=d([55356,56826,55356,56819],[55356,56826,8203,55356,56819]))&&(b=d([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]),!b);case"emoji":return b=d([55358,56760,9792,65039],[55358,56760,8203,9792,65039]),!b}return!1}function f(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var g,h,i,j,k=b.createElement("canvas"),l=k.getContext&&k.getContext("2d");for(j=Array("flag","emoji"),c.supports={everything:!0,everythingExceptFlag:!0},i=0;i<j.length;i++)c.supports[j[i]]=e(j[i]),c.supports.everything=c.supports.everything&&c.supports[j[i]],"flag"!==j[i]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[j[i]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(h=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",h,!1),a.addEventListener("load",h,!1)):(a.attachEvent("onload",h),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),g=c.source||{},g.concatemoji?f(g.concatemoji):g.wpemoji&&g.twemoji&&(f(g.twemoji),f(g.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel='stylesheet' id='events-manager-css'  href='wp-content/plugins/events-manager/includes/css/events_manager.css' type='text/css' media='all' />
<link rel='stylesheet' id='tab-styles-css'  href='wp-content/plugins/projectnext-shortcodes/tab-styles.css' type='text/css' media='all' />
<link rel='stylesheet' id='cntctfrm_form_style-css'  href='wp-content/plugins/contact-form-plugin/css/form_style.css' type='text/css' media='all' />
<link rel='stylesheet' id='rotatingtweets-css'  href='wp-content/plugins/rotatingtweets/css/style.css' type='text/css' media='all' />
<link rel='stylesheet' id='dwboomer-style-css'  href='wp-content/themes/boomer-v18/style.css' type='text/css' media='all' />
<link rel='stylesheet' id='dashicons-css'  href='wp-includes/css/dashicons.min.css' type='text/css' media='all' />
<link rel='stylesheet' id='pagepost_css-css'  href='wp-content/themes/boomer-v18/css/pagepost.css' type='text/css' media='all' />
<link rel='stylesheet' id='pnext.utils-css'  href='wp-content/themes/boomer-v18/css/pnext.utils.css' type='text/css' media='all' />
<link rel='stylesheet' id='uploaded_css-css'  href='wp-content/uploads/sites/9/2015/03/wasdev.css' type='text/css' media='screen' />
<script type='text/javascript' src='https://1.www.s81c.com/common/v18/js/www.js'></script>
<script type='text/javascript' src='https://1.www.s81c.com/common/v18/js/dyntabs.js'></script>
<script type='text/javascript' src='https://1.www.s81c.com/common/v18/js/masonry.js'></script>
<script type='text/javascript' src='https://dw1.s81c.com/dw/wp-includes/js/jquery/ui/core.min.js'></script>
<script type='text/javascript' src='https://dw1.s81c.com/dw/wp-includes/js/jquery/ui/widget.min.js'></script>
<script type='text/javascript' src='https://dw1.s81c.com/dw/wp-includes/js/jquery/ui/position.min.js'></script>
<script type='text/javascript' src='https://dw1.s81c.com/dw/wp-includes/js/jquery/ui/mouse.min.js'></script>
<script type='text/javascript' src='https://dw1.s81c.com/dw/wp-includes/js/jquery/ui/sortable.min.js'></script>
<script type='text/javascript' src='https://dw1.s81c.com/dw/wp-includes/js/jquery/ui/datepicker.min.js'></script>
<script type='text/javascript'>
jQuery(document).ready(function(jQuery){jQuery.datepicker.setDefaults({"closeText":"Close","currentText":"Today","monthNames":["January","February","March","April","May","June","July","August","September","October","November","December"],"monthNamesShort":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"nextText":"Next","prevText":"Previous","dayNames":["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],"dayNamesShort":["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],"dayNamesMin":["S","M","T","W","T","F","S"],"dateFormat":"MM d, yy","firstDay":1,"isRTL":false});});
</script>
<script type='text/javascript' src='https://dw1.s81c.com/dw/wp-includes/js/jquery/ui/menu.min.js'></script>
<script type='text/javascript' src='https://dw1.s81c.com/dw/wp-includes/js/wp-a11y.min.js'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var uiAutocompleteL10n = {"noResults":"No results found.","oneResult":"1 result found. Use up and down arrow keys to navigate.","manyResults":"%d results found. Use up and down arrow keys to navigate.","itemSelected":"Item selected."};
/* ]]> */
</script>
<script type='text/javascript' src='https://dw1.s81c.com/dw/wp-includes/js/jquery/ui/autocomplete.min.js'></script>
<script type='text/javascript' src='https://dw1.s81c.com/dw/wp-includes/js/jquery/ui/resizable.min.js'></script>
<script type='text/javascript' src='https://dw1.s81c.com/dw/wp-includes/js/jquery/ui/draggable.min.js'></script>
<script type='text/javascript' src='https://dw1.s81c.com/dw/wp-includes/js/jquery/ui/button.min.js'></script>
<script type='text/javascript' src='https://dw1.s81c.com/dw/wp-includes/js/jquery/ui/dialog.min.js'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var EM = {"ajaxurl":"https:\/\/developer.ibm.com\/wasdev\/wp-admin\/admin-ajax.php","locationajaxurl":"https:\/\/developer.ibm.com\/wasdev\/wp-admin\/admin-ajax.php?action=locations_search","firstDay":"1","locale":"en","dateFormat":"dd\/mm\/yy","ui_css":"https:\/\/developer.ibm.com\/wasdev\/wp-content\/plugins\/events-manager\/includes\/css\/jquery-ui.min.css","show24hours":"1","is_ssl":"1","txt_search":"Search","txt_searching":"Searching...","txt_loading":"Loading..."};
/* ]]> */
</script>
<script type='text/javascript' src='wp-content/plugins/events-manager/includes/js/events-manager.js'></script>
<script type='text/javascript' src='wp-content/plugins/projectnext-shortcodes/tab-dropdown.js'></script>
<script type='text/javascript' src='wp-content/themes/boomer-v18/js/pnext.utils.js'></script>
<script type='text/javascript' src='https://1.www.s81c.com/common/stats/ida_stats.js'></script>
<link rel='https://api.w.org/' href='wp-json/index.html' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://developer.ibm.com/wasdev/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 4.9.9" />
<link rel='shortlink' href='index.html%3Fp=21602.html' />
<link rel="alternate" type="application/json+oembed" href="https://developer.ibm.com/wasdev/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fdeveloper.ibm.com%2Fwasdev%2Fdocs%2Fwriting-simple-microprofile-application-2-adding-persistence%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://developer.ibm.com/wasdev/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fdeveloper.ibm.com%2Fwasdev%2Fdocs%2Fwriting-simple-microprofile-application-2-adding-persistence%2F&#038;format=xml" />
<link rel='https://github.com/WP-API/WP-API' href='https://developer.ibm.com/wasdev/wp-json' />
<style type="text/css" id="syntaxhighlighteranchor"></style>
		<style type="text/css" id="wp-custom-css">
			.videoWrapper {
	position: relative;
	padding-bottom: 56.25%;
/* 16:9 */
	padding-top: 25px;
	height: 0;
}

.videoWrapper iframe {
	position: absolute;
	top: 0;
	left: 0;
	width: 100%;
	height: 100%;
}

.pnpagepost  .pn-listing .pn-list__item .entry-content .entry-meta .byline br {
	display: none;
}

/*Adds border to any screenshot with this class applied. Looks neater and clearer.*/
img.screenshot {
	border: 1px solid #afafaf;
}

/*Adds border to any photo with this class applied. Looks neater and clearer.*/
img.photo {
	border: 1px solid #afafaf;
}

/*Nests ordered lists correctly.*/
ol>li ol>li::before {
	content: counter(item, lower-alpha)".";
}

ol>li ol>li ol>li::before {
	content: counter(item, lower-roman)".";
}

/* hiding the doubled up author images */
.pn-listing .pn-list__item .byline .avatar {
	display: none !important;
}

/* removing bullets from the EM widget */
.widget-area .widget.widget_em_widget ul li:before,
.widget-area .widget.widget_text ul li:before{display:none;}

/*push anchored h2 headings down from browser top so they're not hidden behind the static headers
h2:before { 
  display: block; 
  content: " "; 
  margin-top: -300px; 
  height: 300px; 
  visibility: hidden; 
}*/

h2 { padding-top: 30px !important; }
		</style>
	
    <link href="https://1.www.s81c.com/common/v18/css/www.css" rel="stylesheet" />
    <link href="https://1.www.s81c.com/common/v18/css/grid-fluid.css" rel="stylesheet">
    <link href="https://1.www.s81c.com/common/v18/css/tables.css" rel="stylesheet">

	<script type="text/javascript">
		 IBMCore.common.util.config.set({
		  "masthead":{
		    "type":"alternate"
		  },
			greeting: { enabled: false },
		  "footer":{
		  	"type":"alternate",
		    "socialLinks":{
		      "enabled":false
		    }
		  },
			survey: { global_percent: 0 }
		});
	 </script>
</head>

<body id="ibm-com" class="doc-template-default single single-doc postid-21602 ibm-com ibm-type group-blog">
	<div style="display:none"></div>
<!--div id="page" class="site"-->
<div id="ibm-top" class="ibm-landing-page">
	<a class="skip-link screen-reader-text" href="index.html%3Fp=21602.html#main">Skip to content</a>

	<!-- MASTHEAD_BEGIN -->
	<div id="ibm-masthead" role="banner" aria-label="IBM" class="ibm-mhtype-minimal">
		<div id="ibm-mast-options">
			<ul role="toolbar" aria-labelledby="ibm-masthead">
				<li id="ibm-geo" role="presentation">
					<a href="http://www.ibm.com/planetwide/select/selector.html">United States</a>
				</li>
			</ul>
		</div>
		<div id="ibm-universal-nav">
			<div id="ibm-home">
				<a href="http://www.ibm.com/us-en/">IBM¨</a>
			</div>
			<div class="dw-nav-left">
				<a href="http://developer.ibm.com" class="dw-logo"><span>IBM Developer</span></a>
							</div>
			<ul id="ibm-menu-links" role="toolbar" aria-label="Site map" class="ibm-hide">
				<li><a href="http://www.ibm.com/sitemap/us/en/">Site map</a></li>
			</ul>
			<div id="ibm-search-module" role="search" aria-labelledby="ibm-masthead">
				<!-- form id="ibm-search-form" action="http://www.ibm.com/Search/" method="get" -->
				<form id="ibm-search-form" action="https://www.ibm.com/Search/" method="get">
					<p>
						<label for="q"><span class="ibm-access">Search</span></label>
						<input type="text" maxlength="100" value="" name="q" id="q"/>
						<input type="hidden" name="v" value="18" />
						<input type="hidden" name="en" value="utf" />
						<input type="hidden" name="lang" value="en" />
						<input type="hidden" name="cc" value="us" />
						<input type="hidden" name="sn" value="dw" />
						<input type="hidden" name="dw" value="dws" />

						<span class="ibm-search-scope">
							<input type="checkbox" class="ibm-styled-checkbox" name="sn" value="Search standards" checked id="scopeoption">
							<label for="scopeoption">Search WASdev</label>
						</span>

						<input type="submit" id="ibm-search" class="ibm-btn-search" value="Submit"/>
					</p>
				</form>
									<form class="ibm-hide" id="devcenter-search-form" action="index.html%3Fp=719.html" method="get">
						<p>
							<label for="pnext-search-input" class="screen-reader-text">Search</label>
							<input maxlength="100" required aria-required="true" id="q" class="pn-search-input pn-nav-search-input fl" name="q" type="text">
							<input type="submit" id="ibm-search" class="ibm-btn-search" value="Seach"/>
						</p>
					</form>
								</div>
		</div>
	</div>
  <!-- MASTHEAD_END -->
  <div id="ibm-content-wrapper">
  	<header role="banner" aria-labelledby="ibm-pagetitle-h1">
  		<!-- MASTHEAD_SITENAV_BEGIN -->
<div class="ibm-sitenav-menu-container">
  <div class="ibm-sitenav-menu-name">
    <a href="docs/portlet-container-differences-liberty-full-profile/index.html" rel="home">WASdev</a>
  </div>
    <div class="ibm-sitenav-menu-list"><ul id="primary-menu" class="menu"><li id="menu-item-11996" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-11996"><a title="About WebSphere Liberty" href="docs/introducing_the_liberty_profile/index.html">About</a></li>
<li id="menu-item-12338" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-12338"><a href="getstarted/index.html">Get Started</a></li>
<li id="menu-item-8368" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-8368"><a title="Download Liberty, features, and samples" href="downloads/websphere-application-server-migration-tools/index.html">Downloads</a></li>
<li id="menu-item-2816" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-2816"><a title="Articles and videos for developers" href="docs.html">Docs</a></li>
<li id="menu-item-12458" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-12458"><a title="Open source code on Github" href="https://github.com/wasdev">Source Code</a></li>
<li id="menu-item-718" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-718"><a title="All the ways you can get help developing on Liberty" href="help.html">Get Help</a></li>
<li id="menu-item-2415" class="menu-item menu-item-type-post_type menu-item-object-page current_page_parent menu-item-2415"><a title="News, events, and opinions on WAS Liberty" href="blog.html">News &#038; Events</a></li>
</ul></div></div>
<!-- MASTHEAD_SITENAV_END -->
  	</header>
<style>#ibm-com .gsc-adBlock{display:none !important;}</style>
<div id="content" class="site-content">
<div id="primary" class="content-area ibm-columns pnpagepost">
		<header class="pagepost-entry-header"><div class="pn_categories"><span><b>in </b><a href="docs/category/coding/index.html" rel="tag">Coding</a><i>, </i><a href="docs/category/java-ee/index.html" rel="tag">Java EE</a></span></div><h1 class="entry-title">Writing a simple MicroProfile application (2): Adding persistence</h1><div class="entry-meta"><div class="pn_byline"><br><span class="author vcard"><a class="url fn n" href="blog/author/notatibm/index.html">Alasdair</a></span><br>Published on March 8, 2017<i> / Updated on March 16, 2017</i></div><div class="pn_slic"><a href="index.html%3Fp=21602.html#comments" class="pn_comments_icon">0 <i>Comments</i></a></div></div></header>		<section class="ibm-fluid">
			<div class="ibm-col-12-3">
				<nav role="left-nav" id="pnext_cpt_leftnav">
									<div id="ibm-navigation">
										<ul class="doc_categories" id="pnext_cpt_leftnav__links" role="tree" aria-labelledby="ibm-pagetitle-h1">
											<li id="ibm-overview" class="cat-all"><a href="docs.html">All Documentation</a><a href="index.html%3Fp=21602.html#" class="pnext_cpt_leftnav_expand ibm-chevron-down-link"><i>expand</i></a></li>	<li class="cat-item cat-item-345"><a href="docs/category/open-liberty/index.html" >Open Liberty <span class="count">(19)</span></a>
</li>
	<li class="cat-item cat-item-333"><a href="docs/category/knowledge-centers/index.html" >Official documentation <span class="count">(5)</span></a>
</li>
	<li class="cat-item cat-item-84"><a href="docs/category/installation/index.html" >Installation <span class="count">(9)</span></a>
</li>
	<li class="cat-item cat-item-80"><a href="docs/category/getting-started/index.html" >Getting started with Liberty <span class="count">(7)</span></a>
</li>
	<li class="cat-item cat-item-88"><a href="docs/category/migration-articles/index.html" >Migration <span class="count">(3)</span></a>
</li>
	<li class="cat-item cat-item-85"><a href="docs/category/coding/index.html" >Coding <span class="count">(80)</span></a>
</li>
	<li class="cat-item cat-item-335"><a href="docs/category/tools/index.html" >Tools <span class="count">(3)</span></a>
</li>
	<li class="cat-item cat-item-212"><a href="docs/category/java-ee/index.html" >Java EE <span class="count">(53)</span></a>
</li>
	<li class="cat-item cat-item-330"><a href="docs/category/microprofile/index.html" >MicroProfile <span class="count">(13)</span></a>
</li>
	<li class="cat-item cat-item-210"><a href="docs/category/osgi-techs/index.html" >OSGi <span class="count">(12)</span></a>
</li>
	<li class="cat-item cat-item-226"><a href="docs/category/extensions/index.html" >Extending Liberty <span class="count">(6)</span></a>
</li>
	<li class="cat-item cat-item-223"><a href="docs/category/oss/index.html" >Liberty with open source <span class="count">(15)</span></a>
</li>
	<li class="cat-item cat-item-225"><a href="docs/category/workflow/index.html" >Setting up your Liberty workflow <span class="count">(6)</span></a>
</li>
	<li class="cat-item cat-item-86"><a href="docs/category/devops/index.html" >DevOps <span class="count">(57)</span></a>
</li>
	<li class="cat-item cat-item-273"><a href="docs/category/security/index.html" >Security <span class="count">(10)</span></a>
</li>
	<li class="cat-item cat-item-208"><a href="docs/category/internet-of-things/index.html" >Internet of Things <span class="count">(6)</span></a>
</li>
	<li class="cat-item cat-item-241"><a href="docs/category/rtcomm/index.html" >Real-time comms <span class="count">(1)</span></a>
</li>
	<li class="cat-item cat-item-274"><a href="docs/category/microservices/index.html" >Microservices <span class="count">(3)</span></a>
</li>
	<li class="cat-item cat-item-209"><a href="docs/category/cloud/index.html" >Cloud <span class="count">(22)</span></a>
</li>
	<li class="cat-item cat-item-126"><a href="docs/category/labs/index.html" >Labs <span class="count">(2)</span></a>
</li>
	<li class="cat-item cat-item-111"><a href="docs/category/fun-projects/index.html" >Fun projects <span class="count">(7)</span></a>
</li>
	<li class="cat-item cat-item-82"><a href="docs/category/videos/index.html" >Videos <span class="count">(25)</span></a>
</li>
	<li class="cat-item cat-item-83"><a href="docs/category/podcasts/index.html" >Podcasts <span class="count">(1)</span></a>
</li>
	<li class="cat-item cat-item-94"><a href="docs/category/early-access/index.html" >Early Access <span class="count">(7)</span></a>
</li>
</ul>
									</div>
								</nav>			</div>
			<div class="ibm-col-12-9 entry-content">
				<main id="main" class="site-main" role="main">
														<p>In my <a href="index.html%3Fp=21318.html">writing a simple MicroProfile application</a> article, I went through the steps in creating a simple meeting coordination application. In this article I&#8217;ll take you through how to update that MicroProfile application to add persistence.</p>
<p>At the time this article was written the MicroProfile has not defined a persistence mechanism. This isn&#8217;t because MicroProfile doesn&#8217;t view persistence as important, but indicates the many equally valid choices that could be made for persistence in microservices. In this article, I use <a href="https://www.mongodb.com/">MongoDB</a> but there are other equally valid options like JPA, Cloudant, Cassandra.</p>
<p>The sample application solves a real problem that the Liberty development team had. The globally-distributed Liberty development team has a lot of online meetings using IBM Connections Cloud Meetings. IBM Connections Cloud provides meeting rooms to individual employees, which is a problem for team meetings if the person who initially set up the meeting room canâ€™t make it (e.g. they were called into another meeting, are on vacation, or sick). The sample application provides a single URL for a meeting, which can then be â€˜startedâ€™ by one person and everyone else gets redirected.</p>
<p>The meeting application is available in <a href="https://github.com/WASdev/sample.microprofile.meetingapp.git">GitHub</a>. Each branch in the repository maps to an article. The starting point for the app for this article is branch <code>part1</code>. By the end of this article, your code should match the code in branch <code>part2</code>.</p>
<p>This article assumes you are using Eclipse and WebSphere Developer Tools (WDT). To install WDT, download and start <a href="http://www.eclipse.org/downloads/packages/eclipse-ide-java-ee-developers/mars2">Eclipse</a>, then drag and drop <a href="http://marketplace.eclipse.org/marketplace-client-intro?mpc_install=1778478" class="drag" title="Drag to your running Eclipse workspace to install WebSphere Developer Tools"><br />
<img src="https://marketplace.eclipse.org//sites/all/themes/solstice/public/images/marketplace/btn-install.png" alt="Drag to your running Eclipse workspace to install WebSphere Developer Tools" /></a> on to the toolbar to start the WDT installer.</p>
<h2>Getting the source into Eclipse from GitHub</h2>
<p>The files for this application are available in <a href="https://github.com/WASdev/sample.microprofile.meetingapp.git">GitHub</a>. To follow this article, you want to clone the repository, check out the <code>part1</code> branch of the repository, and import the project into Eclipse. You can do this from the command line or directly from Eclipse.</p>
<h3>From the command line</h3>
<p>If you prefer to clone the Git repository from the command line:</p>
<ol>
<li>Run the following commands:
<pre>git clone https://github.com/WASdev/sample.microprofile.meetingapp.git
cd sample.microprofile.meetingapp
git checkout part1</pre>
</li>
<li>In Eclipse, import the project as an existing project.</p>
</li>
</ol>
<h3>From Eclipse</h3>
<p>If you prefer to clone the Git repository from Eclipse:</p>
<ol>
<li>In Eclipse, switch to the Git perspective.</li>
<li>Click <strong>Clone a Git repository</strong> from the Git Repositories view.</li>
<li>Enter URI <code>https://github.com/WASdev/sample.microprofile.meetingapp.git</code></li>
<li>Click <strong>Next</strong>, then click <strong>Next</strong> again accepting the defaults.</li>
<li>From the <strong>Initial branch</strong> drop-down list, click <strong>part1</strong>.</li>
<li>Select <strong>Import all existing Eclipse projects after clone finishes</strong>, then click <strong>Finish</strong>.</li>
<li>Switch to the Java EE perspective.</li>
</ol>
<p>The <code>meetings</code> project is automatically created in the Project Explorer view.</p>
<h2>Installing MongoDB</h2>
<p>Depending on what platform you are on the installation instructions may be different. For this exercise you should get the community version of MongoDB from the <a href="https://www.mongodb.com/download-center#community">MongoDB download-center</a>.</p>
<p>Once installed you can run the MongoDB database daemon using:</p>
<pre class="brush: plain; title: ; notranslate" title="">
mongod -dbpath &lt;path to database&gt;
</pre>
<p>The database needs to be running for the application to work. If it isn&#8217;t running there will be a lot of noise in the server logs.</p>
<h2>Updating the application to compile against the MongoDB API</h2>
<p>To start writing code, the Maven <code>pom.xml</code> needs to be updated to indicate the dependency on MongoDB:</p>
<ol>
<li>Open the <code>pom.xml</code>.</li>
<li>On the editor select the <strong>Dependencies</strong> tab.</li>
<li>On the dependencies tab there are two sections, one for Dependencies, and the other for Dependency Management. Just to the right of the Dependencies box there is a <strong>Add</strong> button. Click the <strong>Add</strong> button.</li>
<li>Enter a <strong>groupdId</strong> of <code>org.mongodb</code></li>
<li>Enter a <strong>artifactId</strong> of <code>mongo-java-driver</code></li>
<li>Enter a <strong>version</strong> of <code>2.14.3</code></li>
<li>In the <strong>scope</strong> drop-down, select <strong>provided</strong>. This will allow the application to compile, but will prevent the Maven WAR packager putting the API in the WAR file. Later the build will be configured to make it available to the server.</li>
<li>Click <strong>OK</strong></li>
<li>Save the <code>pom.xml</code>.</li>
</ol>
<h2>Update MeetingsUtil to convert between MongoDB and JSON-Processing objects</h2>
<p>When updating the application, we need to convert between the MongoDB representation of data and the JSON-Processing one. Rather than scatter this around this can be placed in the <code>MeetingsUtil</code> class:</p>
<ol>
<li>Open the <code>MeetingsUtil</code> class from <strong>meetings > Java Resources > src/main/java > net.wasdev.samples.microProfile.meetings > MeetingsUtil.java</strong></li>
<li>The first method that is needed takes a MongoDB <code>DBObject</code> and returns a <code>JsonObject</code>. At the beginning of the file, after the class definition, add the method declaration:
<pre class="brush: java; title: ; notranslate" title="">
    public static JsonObject meetingAsJsonObject(DBObject obj) {
        // method body will go here
    }
</pre>
</li>
<li>This introduces one new class, the <code>DBObject</code> class is in the <code>com.mongodb</code> package:
<pre class="brush: java; title: ; notranslate" title="">
    import com.mongodb.DBObject;
</pre>
</li>
<li>The first step in creating a new <code>JsonObject</code> is to create a <code>JsonObjectBuilder</code> using the <code>JSON</code> class. All of these are already used in the class so no new imports will be required. Add the following line to the start of the method:
<pre class="brush: java; highlight: [2]; title: ; notranslate" title="">
    public static JsonObject meetingAsJsonObject(DBObject obj) {
        JsonObjectBuilder builder = Json.createObjectBuilder();
</pre>
</li>
<li>The JSON object for a meeting uses a field called <code>id</code>. MongoDB uses <code>_id</code> for the same function, so <code>id</code> in JSON will map to <code>_id</code> in MongoDB. To extract the <code>id</code> field from the <code>DBObject</code> and add it to the JSON, add this line to the method:
<pre class="brush: java; title: ; notranslate" title=""> 
        builder.add(&quot;id&quot;, (String) obj.get(&quot;_id&quot;));
</pre>
</li>
<li>The <code>title</code> field can be directly mapped from JSON to the MongoDB object. The <code>title</code> is a String but, to ensure the right add method is called, cast it to a String. Add this line:
<pre class="brush: java; title: ; notranslate" title="">
         builder.add(&quot;title&quot;, (String) obj.get(&quot;title&quot;));
</pre>
</li>
<li>The <code>duration</code> field is a Long. As before it needs to be cast to a Long to ensure the right <code>add</code> method is called:
<pre class="brush: java; title: ; notranslate" title="">
        builder.add(&quot;duration&quot;, (Long) obj.get(&quot;duration&quot;));
</pre>
</li>
<li>If a meeting is running it&#8217;ll have a <code>meetingURL</code> field. If it isn&#8217;t running it&#8217;ll return null. If there is no <code>meetingURL</code> field, we don&#8217;t want to add it to the meeting returned so we want to only add if <code>meetingURL</code> is non-null. Add this:
<pre class="brush: java; title: ; notranslate" title="">
        String meetingURL = (String) obj.get(&quot;meetingURL&quot;);
        if (meetingURL != null)
            builder.add(&quot;meetingURL&quot;, meetingURL);
</pre>
</li>
<li>Finally we need to return a JsonObject. This can be obtained by calling the build method on the <code>JsonObjectBuilder</code>. Add this:
<pre class="brush: java; title: ; notranslate" title="">
        return builder.build();
</pre>
</li>
<li>Next, we need a method that does the opposite, mapping from a <code>JsonObject</code> to a <code>DBObject</code>. This method serves two purposes: It creates a new <code>DBObject</code> and it merges a <code>JsonObject</code> to an existing <code>DBObject</code>, so that it has two parameters rather than one. After the end of the previous method add this:
<pre class="brush: java; title: ; notranslate" title="">
    public static DBObject meetingAsMongo(JsonObject json, DBObject mongo) {
        // method body will go here
    }
</pre>
</li>
<li>The first thing to do in this new method is check if the <code>DBObject</code> passed in is null. If it is null, a new <code>DBObject</code> is created. <code>DBObject</code> is abstract so a <code>BasicDBObject</code> is what will be instantiated. At the beginning of the method add this (there will be a compile error after this but don&#8217;t worry, it&#8217;ll be fixed soon):
<pre class="brush: java; title: ; notranslate" title="">
        if (mongo == null) {
            mongo = new BasicDBObject();
</pre>
</li>
<li>Next, the <code>id</code> needs to be moved from the <code>JsonObject</code> to the new <code>DBObject</code>. This should only be done when a new <code>DBObject</code> is created because, otherwise, a disconnect between the URL and the <code>JsonObject</code> could result in an <code>id</code> being incorrectly overwritten. Add this:
<pre class="brush: java; title: ; notranslate" title="">
            mongo.put(&quot;_id&quot;, json.getString(&quot;id&quot;));
        }
</pre>
</li>
<li>This introduced a new class, the <code>BasicDBObject</code> which is in the <code>com.mongodb</code> package but needs to be imported:
<pre class="brush: java; title: ; notranslate" title="">
    import com.mongodb.BasicDBObject;
</pre>
</li>
<li>The <code>title</code> field is a direct mapping from the <code>JsonObject</code> to the <code>DBObject</code> but the <code>JsonObject</code> contains a <code>JsonString</code> which needs to be converted to a <code>String</code>. The <code>toString</code> method can&#8217;t be used for this because it wraps the <code>String</code> literal with quotes, which isn&#8217;t required here. Fortunately <code>JsonObject</code> provides a convenient <code>getString</code> method for this:
<pre class="brush: java; title: ; notranslate" title="">
        mongo.put(&quot;title&quot;, json.getString(&quot;title&quot;));
</pre>
</li>
<li>The <code>duration</code> field is also a direct mapping but it&#8217;s a <code>JsonNumber</code> in the <code>JsonObject</code>, which needs to be converted to a Long to go into the <code>DBObject</code>:
<pre class="brush: java; title: ; notranslate" title="">
       mongo.put(&quot;duration&quot;, ((JsonNumber) json.get(&quot;duration&quot;)).longValue());
</pre>
</li>
<li>This introduced the <code>JsonNumber</code>, which needs to be imported:
<pre class="brush: java; title: ; notranslate" title="">
import javax.json.JsonNumber;
    </pre>
</li>
<li>We want to get the <code>meetingURL</code> but, since it might not be there, you can&#8217;t use the <code>getString</code> method because it&#8217;ll throw a <code>NullPointerException</code> if there is no field with that name. To get around this, use the <code>get</code> method, which returns a <code>JsonString</code>. A null check can then be performed and only if it is non-null will it be added to the JSON. The <code>getString</code> method must be used since <code>toString</code> wraps the string in quotes:
<pre class="brush: java; title: ; notranslate" title="">
       JsonString jsonString = json.getJsonString(&quot;meetingURL&quot;);
        if (jsonString != null) {
            mongo.put(&quot;meetingURL&quot;, jsonString.getString());
        }
 </pre>
</li>
<li>This introduced the <code>jsonString</code>, which needs to be imported:
<pre class="brush: java; title: ; notranslate" title="">
    import javax.json.JsonString;
</pre>
</li>
<li>Finally return the mongo object and save the file.
<pre class="brush: java; title: ; notranslate" title="">
       return mongo;
</pre>
</li>
</ol>
<h2>Updating the MeetingManager</h2>
<p>The <code>MeetingManager</code> currently makes use of a <code>ConcurrentMap</code> to store the meetings. All the code that integrates with this needs to be updated. In this section this is done one step at a time; as a result there will be compililation errors until you get to the end:</p>
<ol>
<li>Open the <code>MeetingManager</code> class from <strong>meetings > Java Resources > src/main/java > net.wasdev.samples.microProfile.meetings > MeetingManager.java</strong>.</li>
<li>After the class definition delete the following line from the file:
<pre class="brush: java; title: ; notranslate" title="">
	private ConcurrentMap&lt;String, JsonObject&gt; meetings = new ConcurrentHashMap&lt;&gt;();
</pre>
</li>
<li>To interact with MongoDB, an instance of <code>DB</code> needs to be injected. This can be done using the <code>@Resource</code> annotation which can identify which resource from JNDI to inject. Add the code where the <code>ConcurrentMap</code> was removed (in the previous step):
<pre class="brush: java; title: ; notranslate" title="">
	@Resource(name=&quot;mongo/sampledb&quot;)
	private DB meetings;
</pre>
</li>
<li>This pulls in two new classes. The MongoDB <code>DB</code> class and the Java EE <code>@Resource</code> annotation. These need to be imported:
<pre class="brush: java; title: ; notranslate" title="">
    import javax.annotation.Resource;
    import com.mongodb.DB;
</pre>
</li>
<li>MongoDB stores entries in a collection in the database. The first thing to do when writing or reading is to select the collection. To simplify code later on, let&#8217;s create a convenience method to get the collection:
<pre class="brush: java; title: ; notranslate" title="">
    public DBCollection getColl() {
        return meetings.getCollection(&quot;meetings&quot;);
    }
</pre>
</li>
<li>This introduces a new class, the <code>DBCollection</code> class, which is in the <code>com.mongodb</code> package. This needs to be imported:
<pre class="brush: java; title: ; notranslate" title="">
    import com.mongodb.DBCollection;
</pre>
</p>
</li>
<li>
<p>Find and edit the <code>add</code> method:</p>
<ol>
<li>Remove the method body from the <code>add</code> method. This will be replaced to update the database.
<pre class="brush: java; highlight: [2]; title: ; notranslate" title="">
    public void add(JsonObject meeting) {
        // code will be added here
    }
</pre>
</li>
<li>First get the collection.
<pre class="brush: java; title: ; notranslate" title="">
        DBCollection coll = getColl();
    </pre>
</li>
<li>The method is given a <code>JsonObject</code> and we need a <code>DBObject</code> for mongoDB, so we need to convert. The API can take an existing entry from the database, so first lets see if we can find something from the database using the findOne method:
<pre class="brush: java; title: ; notranslate" title="">
        DBObject existing = coll.findOne(meeting.getString(&quot;id&quot;));
</pre>
</li>
<li>This introduces a new class, the <code>DBObject</code> class which is in the <code>com.mongodb</code> package. This needs to be imported:
<pre class="brush: java; title: ; notranslate" title="">
    import com.mongodb.DBObject;
</pre>
</li>
<li>Next call the <code>MeetingsUtil</code> convenience method to convert from <code>JsonObject</code> to <code>DBObject</code>:
<pre class="brush: java; title: ; notranslate" title="">
        DBObject obj = MeetingsUtil.meetingAsMongo(meeting,  existing);
</pre>
</li>
<li>Finally save the new or changed <code>DBObject</code> back into the database:
<pre class="brush: java; title: ; notranslate" title="">
        coll.save(obj);
</pre>
</li>
</ol>
</li>
<li>Find and update the <code>get</code> method:
<ol>
<li>Remove the method body from the <code>get</code> method (this will be replaced to fetch from the database):
<pre class="brush: java; title: ; notranslate" title="">
    public JsonObject get(String id) {
        // code will be added here
    }
</pre>
</li>
<li>To get a single entry the collection needs to be obtained, an entry found by <code>id</code>, and then converted to a <code>JsonObject</code> using the utility method created earlier. Add the following line to the <code>get</code> method:
<pre class="brush: java; title: ; notranslate" title=""> 
        return MeetingsUtil.meetingAsJsonObject(getColl().findOne(id));
</pre>
</li>
</ol>
</li>
<li>Find and update the <code>list</code> method. The <code>list</code> method is slightly more complicated to update. The general structure stays the same but for loop will change. To iterate over entries in a collection a <code>DBCursor</code> is used and that returns a <code>DBObject</code>. The <code>DBObject</code> then needs to be converted to a <code>JsonObject</code>. Replace the existing loop that looks like this:
<pre class="brush: java; title: ; notranslate" title="">
        for (JsonObject meeting : meetings.values()) {
            results.add(meeting);
        }
    </pre>
<p>with this one </p>
<pre class="brush: java; title: ; notranslate" title="">
        for (DBObject meeting : getColl().find()) {
            results.add(MeetingsUtil.meetingAsJsonObject(meeting));
        }
</pre>
</p>
</li>
<li>
<p>Find and update the <code>startMeeting</code> method:</p>
<ol>
<li>This change will radically simplify the code because there is no need to create and merge multiple <code>JsonObject</code>s. Instead, you can simply add the <code>meetingURL</code> to the existing <code>DBObject</code>. The <code>id</code> and <code>url</code> will still need to be fetched from the <code>JsonObject</code>. Remove the following lines from the <code>startMeeting</code> method:
<pre class="brush: java; title: ; notranslate" title="">
        JsonObject existingMeeting = meetings.get(id);
        JsonObject updatedMeeting = MeetingsUtil.createJsonFrom(existingMeeting).add(&quot;meetingURL&quot;, url).build();
        meetings.replace(id, existingMeeting, updatedMeeting);
</pre>
</li>
<li>After the <code>id</code> and <code>url</code> are fetched, replace the removed code with the following four lines to get a collection, find the meeting entry, set the <code>meetingURL</code>, and then save it back to the database:
<pre class="brush: java; title: ; notranslate" title="">
        DBCollection coll = getColl();
        DBObject obj = coll.findOne(id);
        obj.put(&quot;meetingURL&quot;, url);
        coll.save(obj);
</pre>
</li>
</ol>
</li>
<li>Save the file.</li>
</ol>
<p>The MeetingManager is now able to persist to a MongoDB database and back. However, the server still needs to be configured to enable it. This consists of two parts: First, server configuration and, second, getting the server runtime set up.</p>
<h2>Updating the Server Configuration</h2>
<p>The server configuration is part of the project so first let&#8217;s configure that:</p>
<ol>
<li>Open the <code>server.xml</code> from <strong>src > main > liberty > config > server.xml</strong>.</li>
<li>There are several lines commented out. These need to be uncommented and then modified. The following lines should have the surrounding comment markers removed:
<pre class="brush: xml; title: ; notranslate" title="">
    &lt;featureManager&gt;
        &lt;feature&gt;&lt;/feature&gt;
    &lt;/featureManager&gt;
</pre>
</li>
<li>Between the open and close feature tag add <code>mongodb-2.0</code>. It should look like this:
<pre class="brush: xml; title: ; notranslate" title="">
    &lt;featureManager&gt;
        &lt;feature&gt;mongodb-2.0&lt;/feature&gt;
    &lt;/featureManager&gt;
</pre>
</li>
<li>A shared library needs to be defined to be used by the application and the runtime for defining the MongoDB resources:
<pre class="brush: xml; title: ; notranslate" title="">
    &lt;library id=&quot;mongodriver&quot;&gt;
      &lt;file name=&quot;${shared.resource.dir}/mongo-java-driver.jar&quot;/&gt;
    &lt;/library&gt;
</pre>
</li>
<li>Next the <code>mongo</code> needs to be defined. This tells the server where the <code>mongo</code> server instance is running:
<pre class="brush: xml; title: ; notranslate" title="">
    &lt;mongo id=&quot;mongo&quot; libraryRef=&quot;mongodriver&quot;&gt;
      &lt;ports&gt;27017&lt;/ports&gt;
      &lt;hostNames&gt;localhost&lt;/hostNames&gt;
    &lt;/mongo&gt;
</pre>
</li>
<li>Next, define the database:
<pre class="brush: xml; title: ; notranslate" title="">
    &lt;mongoDB databaseName=&quot;meetings&quot; jndiName=&quot;mongo/sampledb&quot; mongoRef=&quot;mongo&quot;/&gt;
</pre>
</li>
<li>Finally, configure the application so it can see the MongoDB classes:
<pre class="brush: xml; title: ; notranslate" title="">
    &lt;webApplication location=&quot;meetings-${project.version}.war&quot;&gt;
      &lt;classloader commonLibraryRef=&quot;mongodriver&quot;/&gt;
    &lt;/webApplication&gt;
</pre>
</li>
<li>Save the file.</li>
</ol>
<p>The next step is to configure the Maven build to make sure all the resources end up in the right place.</p>
<h2>Updating the Maven POM</h2>
<p>The Maven POM needs to be updated to do a few things: It needs to copy the MongoDB Java driver into the Liberty server, define an additional bootstrap property, copy the application to a different location, and ensure that the <code>mongodb-2.0</code> feature is installed:</p>
<ol>
<li>Open the <code>pom.xml</code> in the root of the project.</li>
<li>Select the <code>pom.xml</code> tab in the editor. </li>
</ol>
<h3>Copy the MongoDB Java driver</h3>
<ol>
<li>Search the file for the string <code>maven-dependency-plugin</code> you should see this in the file:
<pre class="brush: xml; title: ; notranslate" title="">
                &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
                &lt;artifactId&gt;maven-dependency-plugin&lt;/artifactId&gt;
                &lt;version&gt;2.10&lt;/version&gt;
                &lt;executions&gt;
                    &lt;execution&gt;
                        &lt;id&gt;copy-server-files&lt;/id&gt;
                        &lt;phase&gt;package&lt;/phase&gt;
                        &lt;goals&gt;
                            &lt;goal&gt;copy-dependencies&lt;/goal&gt;
                        &lt;/goals&gt;
                        &lt;configuration&gt;
                            &lt;includeArtifactIds&gt;server-snippet&lt;/includeArtifactIds&gt;
                            &lt;prependGroupId&gt;true&lt;/prependGroupId&gt;
                            &lt;outputDirectory&gt;${project.build.directory}/wlp/usr/servers/${wlpServerName}/configDropins/defaults&lt;/outputDirectory&gt;
                        &lt;/configuration&gt;
                    &lt;/execution&gt;
                &lt;/executions&gt;
</pre>
<p>This is copying server snippets from dependencies into the server configuration directory. We are going to add to it instructions to download the <code>mongo-java-driver</code>, copy it to the <code>usr/shared/resources</code> folder, and strip the version off the JAR file name. This last part means we don&#8217;t have to remember to update the <code>server.xml</code> every time the dependency version is upgraded.</p>
</li>
<li>
<p>To add these additional instructions, add the following lines after the <code>&lt;/execution&gt;</code> closing tag:</p>
<pre class="brush: xml; title: ; notranslate" title="">
                    &lt;execution&gt;
                        &lt;id&gt;copy-mongodb-dependency&lt;/id&gt;
                        &lt;phase&gt;package&lt;/phase&gt;
                        &lt;goals&gt;
                            &lt;goal&gt;copy-dependencies&lt;/goal&gt;
                        &lt;/goals&gt;
                        &lt;configuration&gt;
                            &lt;includeArtifactIds&gt;mongo-java-driver&lt;/includeArtifactIds&gt;
                            &lt;outputDirectory&gt;${project.build.directory}/wlp/usr/shared/resources/&lt;/outputDirectory&gt;
                            &lt;stripVersion&gt;true&lt;/stripVersion&gt;
                        &lt;/configuration&gt;
                    &lt;/execution&gt;
</pre>
</p>
</li>
</ol>
<h3>Place <code>project.version</code> into <code>bootstrap.properties</code></h3>
<p>The <code>server.xml</code> references the WAR by artifact name and version. The version is referenced using a variable which needs to be provided to the server. This can easily be done using the <code>bootstrap.properties</code>:</p>
<ol>
<li>Search the <code>pom.xml</code> file for the string <code>&lt;bootstrapProperties&gt;</code>. You should see this in the file:
<pre class="brush: xml; title: ; notranslate" title="">
                    &lt;bootstrapProperties&gt;
                        &lt;default.http.port&gt;${testServerHttpPort}&lt;/default.http.port&gt;
                        &lt;default.https.port&gt;${testServerHttpsPort}&lt;/default.https.port&gt;
                    &lt;/bootstrapProperties&gt;
</pre>
</li>
<li>Before the closing <code>&lt;/bootstrapProperties&gt;</code> add the following line:
<pre class="brush: xml; title: ; notranslate" title="">
                        &lt;project.version&gt;${project.version}&lt;/project.version&gt;
</pre>
</li>
</ol>
<h3>Copy the application to the <code>apps</code> folder</h3>
<p>The Maven POM deploys the application into the <code>dropins</code> folder of the Liberty server but this doesn&#8217;t allow a shared library to be used. So, instead, the application needs to be copied to the <code>apps</code> folder:</p>
<ol>
<li>Search in the <code>pom.xml</code> for the string &#8216;dropins&#8217;, you should see this:
<pre class="brush: xml; title: ; notranslate" title="">
                        &lt;goals&gt;
                            &lt;goal&gt;copy-resources&lt;/goal&gt;
                        &lt;/goals&gt;
                        &lt;configuration&gt;
                          &lt;outputDirectory&gt;${project.build.directory}/wlp/usr/servers/${wlpServerName}/dropins&lt;/outputDirectory&gt;
</pre>
</li>
<li>Update the word dropins to be apps. It should look like this:
<pre class="brush: xml; title: ; notranslate" title="">
                        &lt;configuration&gt;
                          &lt;outputDirectory&gt;${project.build.directory}/wlp/usr/servers/${wlpServerName}/apps&lt;/outputDirectory&gt;
</pre>
</li>
</ol>
<h3>Install the <code>mongodb-2.0</code> feature from the Liberty repository</h3>
<p>The <code>mongodb-2.0</code> feature is not in the Liberty server installations that are stored in the Maven repository so it needs to be downloaded from the Liberty repository at build time:</p>
<ol>
<li>Search the <code>pom.xml</code> for the string <code>package-server</code>, you should see this:
<pre class="brush: xml; title: ; notranslate" title="">
                    &lt;execution&gt;
                        &lt;id&gt;package-app&lt;/id&gt;
                        &lt;phase&gt;package&lt;/phase&gt;
                        &lt;goals&gt;
                            &lt;goal&gt;package-server&lt;/goal&gt;
                        &lt;/goals&gt;
                    &lt;/execution&gt;
                  &lt;/executions&gt;
</pre>
</li>
<li>Just before the <code>&lt;/executions&gt;</code> tag, add the following lines to cause the <code>mongodb-2.0</code> feature to be installed:
<pre class="brush: xml; title: ; notranslate" title="">
                    &lt;execution&gt;
                        &lt;id&gt;install-feature&lt;/id&gt;
                        &lt;phase&gt;package&lt;/phase&gt;
                        &lt;goals&gt;
                            &lt;goal&gt;install-feature&lt;/goal&gt;
                        &lt;/goals&gt;
                        &lt;configuration&gt;
                            &lt;features&gt;
                                &lt;acceptLicense&gt;true&lt;/acceptLicense&gt;
                                &lt;feature&gt;mongodb-2.0&lt;/feature&gt;
                            &lt;/features&gt;
                        &lt;/configuration&gt;
                    &lt;/execution&gt;
</pre>
</li>
<li>Save the <code>pom.xml</code>.</li>
</ol>
<h2>Running the application</h2>
<p>There are two ways to get the application running from within WDT:</p>
<ul>
<li>The first is to use Maven to build and run the project:
<ol>
<li>Run the Maven <code>install</code> goal to build and test the project: Right-click <strong>pom.xml</strong> in the <code>meetings</code> project, click <strong>Run As&#8230; > Maven Build&#8230;</strong>, then in the <strong>Goals</strong> field type <code>install</code> and click <strong>Run</strong>. The first time you run this goal, it might take a few minutes to download the Liberty dependencies.</li>
<li>Run a Maven build for the <code>liberty:start-server</code> goal: Right-click <strong>pom.xml</strong>, click <strong>Run As&#8230; > Maven Build</strong>, then in the <strong>Goals</strong> field, type <code>liberty:start-server</code> and click <strong>Run</strong>.  This starts the server in the background.</li>
<li>Open the application, which is available at <code>http://localhost:9080/meetings/</code>.</li>
<li>To stop the server again, run the <code>liberty:stop-server</code> build goal.</li>
</ol>
</li>
<li>The second way is to right-click the <code>meetings</code> project and select <strong>Run As&#8230; > Run on Server</strong> but there are a few things to note if you do this. WDT doesn&#8217;t automatically add the MicroProfile features as you would expect so you need to manually add those. Also, any changes to the configuration in <code>src/main/liberty/config</code> won&#8217;t be picked up unless you add an include.</li>
</ul>
<p>Find out more about <a href="index.html%3Fp=20227.html">MicroProfile and WebSphere Liberty</a>.</p>
<h2>Related articles</h2>
<div class="ibm-fluid pn-grid-listing " >
<div class="ibm-col-12-4 post-1">
<article id="post-21626" class="pn-list__item post-21626 doc type-doc status-publish hentry tag-microprofile doc_categories-coding doc_categories-java-ee randcolor1">
<header class="entry-header"><a class="list-thumbnail" href="index.html%3Fp=21626.html" rel="bookmark"></a></header>
<div class="entry-content">
<div class="entry-hd-wrap">
<h2 class="entry-title"><a href="index.html%3Fp=21626.html" rel="bookmark">Writing a simple MicroProfile application (4): Using WebSockets and CDI events</a></h2>
<div class="entry-meta"><span class="byline"> by <span class="author vcard"><a class="url fn n" href="blog/author/notatibm/index.html">Alasdair</a></span></span> <span class="posted-on"><i>on</i> <span><time class="entry-date published" datetime="">March 29, 2017</time></span></span><span class="pn-categories"><i> in</i> <a href="docs/category/coding/index.html" rel="tag">Coding</a>, <a href="docs/category/java-ee/index.html" rel="tag">Java EE</a></span></div>
</div>
<p class="exc-content">Alasdair takes his <a href="index.html%3Fp=21318.html">simple MicroProfile application</a> and adds WebSockets and CDI Events to notify the client about changes to the meeting. All code is in <a href="https://github.com/WASdev/sample.microprofile.meetingapp.git">GitHub</a>.</p>
<p class="pn-readmore"><span class="pn-readmore"><a href="index.html%3Fp=21626.html" title="Continue reading Writing a simple MicroProfile application (4): Using WebSockets and CDI events">Continue reading <span class="screen-reader-text">Writing a simple MicroProfile application (4): Using WebSockets and CDI events</span></a></span></p>
</div>
</article>
</div>
<div class="ibm-col-12-4 post-2">
<article id="post-21607" class="pn-list__item post-21607 doc type-doc status-publish hentry tag-microprofile doc_categories-coding doc_categories-java-ee randcolor4">
<header class="entry-header"><a class="list-thumbnail" href="index.html%3Fp=21607.html" rel="bookmark"></a></header>
<div class="entry-content">
<div class="entry-hd-wrap">
<h2 class="entry-title"><a href="index.html%3Fp=21607.html" rel="bookmark">Writing a simple MicroProfile application (3): Using Java EE concurrency</a></h2>
<div class="entry-meta"><span class="byline"> by <span class="author vcard"><a class="url fn n" href="blog/author/notatibm/index.html">Alasdair</a></span></span> <span class="posted-on"><i>on</i> <span><time class="entry-date published" datetime="">March 22, 2017</time></span></span><span class="pn-categories"><i> in</i> <a href="docs/category/coding/index.html" rel="tag">Coding</a>, <a href="docs/category/java-ee/index.html" rel="tag">Java EE</a></span></div>
</div>
<p class="exc-content">Alasdair takes his <a href="index.html%3Fp=21318.html">simple MicroProfile application</a> and adds persistence using MongoDB as the persistence mechanism. All code is in <a href="https://github.com/WASdev/sample.microprofile.meetingapp.git">GitHub</a>.</p>
<p class="pn-readmore"><span class="pn-readmore"><a href="index.html%3Fp=21607.html" title="Continue reading Writing a simple MicroProfile application (3): Using Java EE concurrency">Continue reading <span class="screen-reader-text">Writing a simple MicroProfile application (3): Using Java EE concurrency</span></a></span></p>
</div>
</article>
</div>
<div class="ibm-col-12-4 post-3">
<article id="post-21318" class="pn-list__item post-21318 doc type-doc status-publish hentry tag-microprofile doc_categories-coding doc_categories-java-ee randcolor4">
<header class="entry-header"><a class="list-thumbnail" href="index.html%3Fp=21318.html" rel="bookmark"></a></header>
<div class="entry-content">
<div class="entry-hd-wrap">
<h2 class="entry-title"><a href="index.html%3Fp=21318.html" rel="bookmark">Writing a simple MicroProfile application (1)</a></h2>
<div class="entry-meta"><span class="byline"> by <span class="author vcard"><a class="url fn n" href="blog/author/notatibm/index.html">Alasdair</a></span></span> <span class="posted-on"><i>on</i> <span><time class="entry-date published" datetime="">January 11, 2017</time></span></span><span class="pn-categories"><i> in</i> <a href="docs/category/coding/index.html" rel="tag">Coding</a>, <a href="docs/category/java-ee/index.html" rel="tag">Java EE</a></span></div>
</div>
<p class="exc-content">Alasdair introduces MicroProfile by explaining how to write a simple application based around the mundane but real-life requirement to book meetings.</p>
<p class="pn-readmore"><span class="pn-readmore"><a href="index.html%3Fp=21318.html" title="Continue reading Writing a simple MicroProfile application (1)">Continue reading <span class="screen-reader-text">Writing a simple MicroProfile application (1)</span></a></span></p>
</div>
</article>
</div>
</div>
							<footer class="entry-footer" id="doc_author">
								<div class="tags-links">Tags <a href="blog/tag/microprofile/index.html" rel="tag">MicroProfile</a></div><div class="byline"><div><p class="byline__author"><span class="author vcard">by <a class="url fn n" href="blog/author/notatibm/index.html">Alasdair</a></span></p><ul class="byline__social"><li class="byline__social__twitter"><a href="https://www.twitter.com/NottyCode">Twitter</a></li></ul><p class="byline__bio">Hi I'm Alasdair Nottingham, you might remember me from such videos such as "Interview with IBM's Alasdair Nottingham on the WebSphere Liberty Profile", and "OSGi Explained". 

I'm the Liberty runtime architect, which means that I write less code than I would like.

My role in the team is to ensure we stick to our principles, and to ensure we build the best application server for developers, oh and it also needs to rock in production too.</p></div></div>							</footer><!-- .entry-footer -->
							
<div id="comments" class="comments-area">

	
	
	
	

	<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">Join The Discussion <small><a rel="nofollow" id="cancel-comment-reply-link" href="index.html%3Fp=21602.html#respond" style="display:none;">Cancel reply</a></small></h3>			<form action="https://developer.ibm.com/wasdev/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate>
				<p class="comment-notes"><span id="email-notes">Your email address will not be published.</span> Required fields are marked <span class="required">*</span></p><p class="comment-form-comment"><label for="comment">Comment</label><br /><textarea id="comment" name="comment" aria-required="true" placeholder="Enter your comments..."></textarea></p><p class="comment-form-author"><label for="author">Name <span class="required">*</span></label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" required='required' /></p>
<p class="comment-form-email"><label for="email">Email <span class="required">*</span></label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" aria-describedby="email-notes" required='required' /></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="form-submit"><input name="submit" type="submit" id="submit" class="ibm-btn-pri ibm-btn-small ibm-btn-blue-50" value="Post Comment" /> <input type='hidden' name='comment_post_ID' value='21602' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="95ddcb561b" /></p><p style="display: none;"><input type="hidden" id="ak_js" name="ak_js" value="171"/></p>			</form>
			</div><!-- #respond -->
	</div><!-- #comments -->
											</main><!-- #main -->

			</div>
</div>
<script>
	jQuery(document).ready(function($){
		// return;
		$('.cat-item:has(.children)').addClass('arrowryt');
		$('.current-cat:has(.children)').addClass('arrowdwn');
		$('.current-cat-parent, .current-cat-ancestor').addClass('arrowdwn');
		$('<span class="toggler"></span>').prependTo('.cat-item:has(.children)').click(function(e){
			e.preventDefault();
			e.stopPropagation();
			$(this).parent().toggleClass('arrowdwn');
		});
		$('#pnext_cpt_leftnav .pnext_cpt_leftnav_expand').on('click',function(e){
			e.preventDefault();
			$(this).toggleClass('ibm-chevron-up-link');
			$(this).parents('#pnext_cpt_leftnav__links').toggleClass('menuHide');
		})
	});
</script>



		</div><!-- #content -->
	</div><!-- end of ibm-content-wrapper -->

	<p class="ibm-ind-link ibm-nospacing ibm-icononly ibm-btt-auto ibm-hidden-small">
		<a class="ibm-nospacing ibm-top-link" aria-label="Back to top" href="index.html%3Fp=21602.html#top" tabindex="0">Back to top</a>
	</p>

	<footer role="contentinfo" aria-label="IBM" id="themeFooter">
		<div id="boomer-footer" class="boomer_footer_menu"></div>
		<div id="dw-footer" class="ibm-alternate ibm-padding-normal">
			<div class="ibm-columns ibm-padding-bottom-0">
				<div class="ibm-col-1-1">
					<div class="ibm-footer-corporate-links">
						<ul>
              <li><a href="https://developer.ibm.com/feedback/">Contact</a></li>
              <li><a href="https://www.ibm.com/privacy/us/en/">Privacy</a></li>
              <li><a href="https://developer.ibm.com/terms/ibm-developer-terms-of-use/">Terms of use</a></li>
              <li><a href="https://www.ibm.com/accessibility/us/en/">Accessibility</a></li>
              <li class="ibm-feedbacklink"><a href="index.html%3Fp=21602.html#">Feedback</a></li>
							<li><a href="https://www.ibm.com/developerworks/secure/report/">Report Abuse</a></li>
              <li id="ibm-truste-cp"><a onclick="truste.eu.clickListener();return false;" href="index.html%3Fp=21602.html#">Cookie Preferences</a></li>
          	</ul>
					</div>
					<div id="ibm-footer-locale-selector"></div>
				</div>
			</div>
		</div>
	</footer>
</div><!-- #page -->

<script>
        jQuery(document).ready(function($){
          var dcName = 'wasdev';
          // $('a').each(function(){
          //   if(this.href.match('bluemix.net')){
          //     if(this.search){
          //       this.href = this.href + '&cm_sp=dw-bluemix-_-'+dcName+'-_-devcenter';
          //     }else{
          //       this.href = this.href + '?cm_sp=dw-bluemix-_-'+dcName+'-_-devcenter';
          //     }
          //   }
          // });

          jQuery('a[href*="bluemix.net"]').each(function(){
            if(this.search){
              this.href = this.href + '&cm_sp=dw-bluemix-_-'+dcName+'-_-devcenter';
            }else{
              this.href = this.href + '?cm_sp=dw-bluemix-_-'+dcName+'-_-devcenter';
            }
          });

        });
      </script><link rel='stylesheet' id='pn-doccat-styles-css'  href='wp-content/plugins/projectnext-docs-categorical-2/partials/v18/pdc.css' type='text/css' media='all' />
<script type='text/javascript' src='wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shCore.js'></script>
<script type='text/javascript' src='wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushPlain.js'></script>
<script type='text/javascript' src='wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushJava.js'></script>
<script type='text/javascript' src='wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushXml.js'></script>
<script type='text/javascript'>
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "https://developer.ibm.com/wasdev/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.9b";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.getElementsByTagName("head")[0].insertBefore( corecss, document.getElementById("syntaxhighlighteranchor") );
		var themecssurl = "https://developer.ibm.com/wasdev/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?ver=3.0.9b";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		//document.getElementById("syntaxhighlighteranchor").appendChild(themecss);
		document.getElementsByTagName("head")[0].insertBefore( themecss, document.getElementById("syntaxhighlighteranchor") );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.defaults['toolbar'] = false;
	SyntaxHighlighter.all();
</script>
<script type='text/javascript' src='wp-content/themes/boomer-v18/js/navigation.js'></script>
<script type='text/javascript' src='wp-content/themes/boomer-v18/js/skip-link-focus-fix.js'></script>
<script type='text/javascript' src='https://dw1.s81c.com/dw/wp-includes/js/comment-reply.min.js'></script>
<script type='text/javascript' src='https://www.ibm.com/software/info/js/tactic.js'></script>
<script type='text/javascript' src='https://www.ibm.com/software/info/js/tacticbindlinks.js'></script>
<script type='text/javascript' src='wp-content/plugins/page-links-to/js/new-tab.min.js'></script>
<script type='text/javascript' src='https://dw1.s81c.com/dw/wp-includes/js/wp-embed.min.js'></script>
<script async="async" type='text/javascript' src='wp-content/plugins/akismet/_inc/form.js'></script>

<script>
	/* this is where we are going to control the main menu */
	function changeMenu(links) {
		IBMCore.common.module.masthead.editProfileMenu({
			action: "replace",
			links: links
		});
	}

	var setMainMenu = function(){
					var userLinks = [{
				title: "My IBM",
				url: "https://myibm.ibm.com/dashboard/?lnk=mmi"
			},{
				title: "Sign In",
				url: "https://developer.ibm.com/sso/login?d=https%3A%2F%2Fdeveloper.ibm.com%2Fwasdev%2Fdocs%2Fwriting-simple-microprofile-application-2-adding-persistence&lang=en_US"
			},
			{
				title: "Register",
				url: "https://developer.ibm.com/sso/register?lang=en_US&d=https%3A%2F%2Fdeveloper.ibm.com%2Fwasdev%2Fdocs%2Fwriting-simple-microprofile-application-2-adding-persistence"
			}];
				changeMenu(userLinks);
	}

	IBMCore.common.module.masthead.subscribe("profileMenuReady", "customjs", setMainMenu);
</script>
<script>
		(function($) {
			$(document).ready(function(){
				/* prevent the # links in the main menu from firing */
				$('.ibm-sitenav-menu-list #primary-menu a').on('click.stopFakeLinks',function(e){
					$this = $(this);
					if($this.attr('href') === "#"){
						return false;
					}
				});

				/* bind the feedback click evnet */
				jQuery('#dw-footer .ibm-feedbacklink a').on("click", function(evt) {
			        evt.preventDefault();
			        var iframeWidth = 970;
			        if (window.innerWidth < 900) {
			            iframeWidth = window.innerWidth - 80
			        }
			        IBMCore.common.widget.surveyccfintercept.initFeedback({
			            survey: {
			                height: 700,
			                id: "web-exp",
			                metaData: "",
			                type: "medallia",
			                width: iframeWidth
			            }
			        })
			   });
				//testing out the alpha helper
				$('[data-alpha]').each(function(i){
					$elm = $(this);
					var bg = $elm.css('backgroundColor').replace(/[rgb(]/g,'').replace(/ /g,'').replace(/[)]/g,'');
					var alpha = $elm.data('alpha')/100;
					$elm.css("cssText", "background-color: rgba("+bg+","+alpha+") !important;");
				})
				//testing out the panel slider
				$('.pn-sliding-panels').each(function(i){
					$elm = $(this);
					//get the width of the active panel
					var activeWidth = $elm.data('openamount'),
						panelCount = $elm.data('panelcount'),
						inactiveWidth = ((100 - activeWidth) / (panelCount-1));
					//set the first slide as active - later, allow it to be set
					$elm.find('.pn-panel').each(function(i,item){
						$panel = $(item);
						$panel.data('closedwidth',inactiveWidth);
						$panel.data('openwidth',activeWidth);
						if(i == 0){
							$panel.addClass('pn-panel__active').css({width:activeWidth+'%'});
						}else{
							$panel.css({width:inactiveWidth+'%'});
						}
					});

					$elm.on('click.slide','.pn-panel',function(e){
						$this = $(this);
						//console.info('clicked')
						if($this.hasClass('pn-panel__active')){
							//allow for the links in the active panel to be clicked
							//console.info('im open, let the links through')
						}else{
							e.preventDefault();
							//set the width of the currently active panel to the closed amount
							var $active = $this.parents('.pn-sliding-panels').find('.pn-panel__active');
								$active.css({width:$active.data('closedwidth')+'%'}).removeClass('pn-panel__active');
							$this.addClass('pn-panel__active').css({width:$this.data('openwidth')+'%'});
						}

					})
				});

			})
		})( jQuery );
	</script>

	
</body>
</html>
