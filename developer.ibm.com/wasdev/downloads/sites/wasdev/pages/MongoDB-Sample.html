<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<meta http-equiv="cache-control" content="max-age=0" />
<meta http-equiv="cache-control" content="no-cache" />
<meta http-equiv="expires" content="0" />
<meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
<meta http-equiv="pragma" content="no-cache" />
<title>
MongoDB Sample | IBM WebSphere Liberty Repository | WASdev
</title>
<link href="css/marketplace.css%3F_1416284010" rel="stylesheet" type="text/css">
<link rel="schema.DC" href="http://purl.org/DC/elements/1.0/"/>
<link rel="shortcut icon" href="../../../../wp-content/themes/projectnext/css/favicon.ico" />
<meta name="DC.Rights" content="? Copyright IBM Corporation 2016"/>
<meta name="Keywords" content="IBM WebSphere Liberty Repository, IBM Marketplace, wasdev, wasdev community, WebSphere Application Server, download, JazzHub "/>
<meta name="DC.Date" scheme="iso8601" content="2016-10-25"/>
<meta name="Source"  content="developerWorks"/>
<meta name="Security" content="Public"/>
<meta name="Abstract" content="The following sample demonstrates the Liberty Extended Profile's ability to configure a MongoDB database to inject a com.mongodb.DB instance into a class to perform a number of insert/find operations."/>
<meta name="Description" content="The following sample demonstrates the Liberty Extended Profile's ability to configure a MongoDB database to inject a com.mongodb.DB instance into a class to perform a number of insert/find operations."/>
<meta name="IBM.Effective" scheme="W3CDTF" content="2016-10-25"/>
<meta name="Owner" content="developerWorks Content/Raleigh/IBM"/>
<meta name="DC.Language" scheme="rfc1766" content="en"/>
<meta name="IBM.SpecialPurpose" content="SP001"/>
<meta name="IBM.Country" content="ZZ"/>
<meta name="Robots" content="index,follow"/>
<meta name="DC.Type" scheme="IBM_ContentClassTaxonomy" content="CT801" />
<meta name="DC.Subject" scheme="IBM_SubjectTaxonomy" content="ZZ999" />
<script src="https://code.jquery.com/jquery-1.11.1.min.js"></script>
</head>

<body>
<div id="eLoader"></div>
<div id="eMain">
<h1>MongoDB Sample</h1>
<div id="description">
<div id="ibm-wasdev-sample-desc-content"> 
 <p>This sample contains a server definition that includes the MongoDB, JNDI, and Servlet features. The application, mongoDBApp.war, uses the Liberty Extended Profile's ability to configure a MongoDB database to inject a <code>com.mongodb.DB</code> instance into a class to perform a number of insert/find operations. The DB object is injected using a <code>@javax.annotation.Resource</code> annotation using the following code:</p> 
 <blockquote> 
  <code> <pre>
@WebServlet(&quot;/&quot;)
public class MongoServlet extends HttpServlet {
	@Resource(name = &quot;mongo/sampledb&quot;)
	protected DB db;
	...
}
           </pre> </code> 
 </blockquote> 
 <p> <b>This sample assumes that a MongoDB instance is running on <code>localhost:27017</code> (default mongo settings).</b> </p> 
 <p id="ibm-wasdev-supported-runtime-content"> This sample can be installed onto runtime versions 8.5.5.0 and later. </p> 
</div> 
<h2 id="ibm-wasdev-sample-installation-title">Installation Instructions</h2> 
<div id="ibm-wasdev-sample-installation-content"> 
 <p>Online installation (requires 8.5.5.6 or later):</p> 
 <ol> 
  <li>Install the sample by running the command below from the bin directory of your server installation: <pre>installUtility install mongoDBSample</pre> </li> 
 </ol> 
 <p> Any missing features required by the server will be installed for you. </p> 
 <p>Offline installation:</p> 
 <ol> 
  <li>Download the <code>mongoDBSample.jar</code> using the download button at the top of the page and place it in the root of your server installation. </li> 
  <li>Extract the sample into the Liberty installation by running the command below from the root of your server installation: <pre>java -jar mongoDBSample.jar</pre> </li> 
 </ol> 
 <p> Any missing features required by the server will need to be installed separately. </p> 
</div> 
<h2 id="ibm-wasdev-sample-instructions-title">Running The Application</h2> 
<div id="ibm-wasdev-sample-instructions-content"> 
 <p>To run the MongoDB application:</p> 
 <ol> 
  <li>Ensure that the MongoDB instance is running on <code>localhost:27017</code> or update the <code>server.xml</code> file to point to your MongoDB instance see <b>Notes</b> below for more infomation on doing this. </li> 
  <li>Start the mongoDBSample server by running the command below from the <code>bin</code> directory in the Liberty profile installation: <pre>server run mongoDBSample</pre> </li> 
  <li>Confirm the application started by looking for the following message in the log: <pre>CWWKZ0001I: Application mongoDBApp started in XX.XX seconds.</pre> </li> 
  <li>In your browser, enter the URL for the application: <a href="http://localhost:9121/mongoDBApp">http://localhost:9121/mongoDBApp</a> (where port 9121 assumes the httpEndpoint provided in the sample server.xml has not been modified). </li> 
  <li>The <code>com.mongodb.DB</code> resource was injected if you see the following message:<br /> <code>HelloMongo!</code> </li> 
  <li>After HelloMongo! is displayed, a number of elements will also be inserted into the database and the contents of the database will be dumped. See <b>Notes</b> below for example output. </li> 
  <li>Stop the server using the command '<code>bin/server stop mongoDBSample</code>'.</li> 
  <li>Examine the Java source files in the application for more information about how the injection works. </li> 
 </ol> 
</div> 
<h2 id="ibm-wasdev-sample-notes-title">Notes</h2> 
<div id="ibm-wasdev-sample-notes-content"> 
 <p>Example output from a successful run :<br /> <br /> <code> HelloMongo!<br /> [count] collection count = 0 from [sampledb] <br /> [inserting] 10 <br /> [dump entire db] : <br /> { &quot;_id&quot; : { &quot;$oid&quot; : &quot;51684c16ecd91696ca5176a1&quot;} , &quot;user&quot; : 0} <br /> { &quot;_id&quot; : { &quot;$oid&quot; : &quot;51684c17ecd91696ca5176a2&quot;} , &quot;user&quot; : 1} <br /> { &quot;_id&quot; : { &quot;$oid&quot; : &quot;51684c17ecd91696ca5176a3&quot;} , &quot;user&quot; : 2} <br /> { &quot;_id&quot; : { &quot;$oid&quot; : &quot;51684c17ecd91696ca5176a4&quot;} , &quot;user&quot; : 3} <br /> { &quot;_id&quot; : { &quot;$oid&quot; : &quot;51684c17ecd91696ca5176a5&quot;} , &quot;user&quot; : 4} <br /> { &quot;_id&quot; : { &quot;$oid&quot; : &quot;51684c17ecd91696ca5176a6&quot;} , &quot;user&quot; : 5} <br /> { &quot;_id&quot; : { &quot;$oid&quot; : &quot;51684c17ecd91696ca5176a7&quot;} , &quot;user&quot; : 6} <br /> { &quot;_id&quot; : { &quot;$oid&quot; : &quot;51684c17ecd91696ca5176a8&quot;} , &quot;user&quot; : 7} <br /> { &quot;_id&quot; : { &quot;$oid&quot; : &quot;51684c17ecd91696ca5176a9&quot;} , &quot;user&quot; : 8} <br /> { &quot;_id&quot; : { &quot;$oid&quot; : &quot;51684c17ecd91696ca5176aa&quot;} , &quot;user&quot; : 9} <br /> </code> </p> 
 <p>Troubleshooting :</p> 
 <ul> 
  <li>If your MongoDB instance is running somewhere other than the default <code>localhost:27017</code>, you can change the location via the <code>mongo</code> configuration element in the server.xml file.</li> 
  <li>If you see HelloMongo!, but there isn't a following '[count] collection count ...', check the server SystemOut.log. If there is not a mongoDB process running at localhost:27017, you should see the following warning : <pre>'[WARNING ] Server seen down: localhost/127.0.0.1:27017 - java.io.IOException - message: Connection refused: connect'.</pre> The solution to this problem is to start a MongoDB process at the default port on the local machine.</li> 
  <li>If you get a 404 response when you access the sample application and you see a <code>SRVE0187E</code> message, you most likely have a problem with your shared library. Ensure that the library element in the <code>server.xml</code> points to a valid Mongo Java Driver jar file.</li> 
 </ul> 
</div> 
<h2 id="ibm-wasdev-sample-stucture-title">Sample Structure</h2> 
<div id="ibm-wasdev-sample-structure-content"> 
 <ul class="structureitem"> 
  <li class="directory" title="">wlp</li> 
  <ul class="structureitem"> 
   <li class="directory" title="">usr</li> 
   <ul class="structureitem"> 
    <li class="directory" title="">servers</li> 
    <ul class="structureitem"> 
     <li class="directory" title="">mongoDBSample</li> 
     <ul class="structureitem"> 
      <li class="file" title="File: Included in Archive">Copyright.txt</li> 
      <li class="directory" title="">apps</li> 
      <ul class="structureitem"> 
       <li class="file" title="File: Included in Archive">mongoDBApp.war</li> 
      </ul> 
      <li class="directory" title="">lafiles</li> 
      <ul class="structureitem"> 
       <li class="file" title="File: Included in Archive">LA_en</li> 
       <li class="file" title="File: Included in Archive">LI_en</li> 
      </ul> 
      <li class="file" title="File: Included in Archive">readme.html</li> 
      <li class="file" title="File: Included in Archive">server.xml</li> 
     </ul> 
    </ul> 
    <li class="directory" title="">shared</li> 
    <ul class="structureitem"> 
     <li class="directory" title="">resources</li> 
     <ul class="structureitem"> 
      <li class="directory" title="">MongoDBSampleLibs</li> 
      <ul class="structureitem"> 
       <li class="external" title="External Dependency: http://driver-downloads.mongodb.org/java/2.11.1/mongo-java-driver-2.11.1.jar">mongo-java-driver-2.11.1.jar</li> 
      </ul> 
     </ul> 
    </ul> 
   </ul> 
  </ul> 
 </ul> 
</div>

</div>
</div>
<div style="display:none">
<script>$( document ).ready(function() {
	$('#eLoader').height($(window).height());
    setTimeout(function(){
		location.href='https://developer.ibm.com/wasdev/downloads/#asset/samples-MongoDB_Sample';
	},100);
});
</script>
</div>
</body>

</html>
